    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        const sunIcon = themeToggle.querySelector('.sun-icon');
        const moonIcon = themeToggle.querySelector('.moon-icon');

        const savedTheme = localStorage.getItem('theme') || 'dark';
        html.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        themeToggle.addEventListener('click', () => {
            const newTheme = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });

        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            } else {
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            }
        }

        // Mobile Navigation
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileNav = document.getElementById('mobile-nav');
        const mobileNavClose = document.getElementById('mobile-nav-close');

        mobileMenuBtn.addEventListener('click', () => {
            mobileNav.classList.add('open');
            document.body.style.overflow = 'hidden';
        });

        mobileNavClose.addEventListener('click', () => {
            mobileNav.classList.remove('open');
            document.body.style.overflow = '';
        });

        // Scroll Animations
        const revealElements = document.querySelectorAll('.reveal');
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.1 });

        revealElements.forEach(el => revealObserver.observe(el));

        // Navbar scroll effect
        const navbar = document.querySelector('.navbar');
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 100) {
                navbar.style.boxShadow = 'var(--shadow-md)';
            } else {
                navbar.style.boxShadow = 'none';
            }
        });

        // Lead Capture Modal
        const leadModal = document.getElementById('lead-modal');
        const leadModalClose = document.getElementById('lead-modal-close');
        const leadForm = document.getElementById('lead-form');
        const successModal = document.getElementById('success-modal');
        const successModalClose = document.getElementById('success-modal-close');

        function openLeadModal() {
            leadModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLeadModal() {
            leadModal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Open modal on CTA button clicks
        document.querySelectorAll('.btn-open-lead-modal, a[href="#signup"], a[href="/#signup"]').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                openLeadModal();
            });
        });

        // Close modal
        leadModalClose.addEventListener('click', closeLeadModal);

        leadModal.addEventListener('click', (e) => {
            if (e.target === leadModal) {
                closeLeadModal();
            }
        });

        // Handle lead form submission
        leadForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData(leadForm);
            const data = {
                name: `${formData.get('firstName')} ${formData.get('lastName')}`,
                email: formData.get('email'),
                phone: formData.get('phone') || '',
                companySize: formData.get('companySize'),
                source: 'lead-modal',
                timestamp: new Date().toISOString()
            };

            const submitBtn = leadForm.querySelector('.lead-form-submit');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;

            // Google Sheets integration
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxQ5AqA374MPUA_HBuOHjxN22ktzmC_lqNV8fhplih_vsDye9xqWO8QIB-ABJr7qLOsaA/exec';

            try {
                await fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                // Close lead modal and show success modal
                closeLeadModal();
                successModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                leadForm.reset();
            } catch (error) {
                console.error('Error:', error);
                alert('Something went wrong. Please try again.');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        successModalClose.addEventListener('click', () => {
            successModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        successModal.addEventListener('click', (e) => {
            if (e.target === successModal) {
                successModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // Close modal on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeLeadModal();
                successModal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });
    </script>

    <!-- LinkedIn Tag Manager -->
    <script type="text/javascript">
    _linkedin_partner_id = "8577212";
    window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
    window._linkedin_data_partner_ids.push(_linkedin_partner_id);
    </script>
    <script type="text/javascript">
    (function(l) {
    if (!l){window.lintrk = function(a,b){window.lintrk.q.push([a,b])};
    window.lintrk.q=[]}
    var s = document.getElementsByTagName("script")[0];
    var b = document.createElement("script");
    b.type = "text/javascript";b.async = true;
    b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
    s.parentNode.insertBefore(b, s);})(window.lintrk);
    </script>
    <noscript>
    <img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=8577212&fmt=gif" />
    </noscript>
